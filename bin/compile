#!/usr/bin/env elixir

File.mkdir_p!("release")

{:ok, code} = File.read("main.pj")
{:ok, ast} = Code.string_to_quoted(code)

Code.require_file("ast_compiler.ex")
pej_ast = AstCompiler.parse_ast(ast)
AstCompiler.validate_ast(pej_ast)
AstCompiler.compile_prompts(pej_ast)

File.write!("release/main.pjc", inspect(pej_ast))
